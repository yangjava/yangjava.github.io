---
layout: post
categories: Spring
description: none
keywords: Spring
---
# Spring整体架构
Spring是一款用于简化企业级Java应用开发的分层开源框架，它有着强大的扩展、融合能力，善于将各种单层框架完美地糅合在一起，并建立一个完整体系，统一、高效地构造可提供企业级服务的应用系统。

## Spring的整体架构
Spring是于 2003 年兴起的一个轻量级Java开源框架，由Rod Johnson在其著作Expert One-On-One J2EE Design and Development中阐述的部分理念和原型衍生而来。Spring是为了解决企业应用开发的复杂性而创建的，它使用基本的JavaBean来完成以前只可能由EJB完成的事情。然而，Spring的用途不仅限于服务器端的开发，从简单性、可测试性和松耦合的角度而言，任何Java应用都可以从Spring中受益。

Spring框架是一个分层架构，它包含一系列的功能要素，并被分为大约20个模块：
这些模块被总结为以下几部分。
### Core Container
Core Container（核心容器）包含有Core、Beans、Context和Expression Language模块。
Core和Beans模块是框架的基础部分，提供IoC（转控制）和依赖注入特性。这里的基础概念是BeanFactory，它提供对Factory模式的经典实现来消除对程序性单例模式的需要，并真正地允许你从程序逻辑中分离出依赖关系和配置。
Core模块主要包含Spring框架基本的核心工具类，Spring的其他组件都要用到这个包里的类，Core模块是其他组件的基本核心。当然你也可以在自己的应用系统中使用这些工具类。
Beans模块是所有应用都要用到的，它包含访问配置文件、创建和管理bean以及进行Inversion of Control / Dependency Injection（IoC/DI）操作相关的所有类。
Context模块构建于Core和Beans模块基础之上，提供了一种类似于JNDI注册器的框架式的对象访问方法。Context模块继承了Beans的特性，为Spring核心提供了大量扩展，添加了对国际化（例如资源绑定）、事件传播、资源加载和对Context的透明创建的支持。Context模块同时也支持J2EE的一些特性，例如EJB、JMX和基础的远程处理。ApplicationContext接口是Context模块的关键。
Expression Language模块提供了强大的表达式语言，用于在运行时查询和操纵对象。它是JSP 2.1规范中定义的unifed expression language的扩展。该语言支持设置/获取属性的值，属性的分配，方法的调用，访问数组上下文（accessiong the context of arrays）、容器和索引器、逻辑和算术运算符、命名变量以及从Spring的IoC容器中根据名称检索对象。它也支持list投影、选择和一般的list聚合。
### Data Access/Integration
- Data Access/Integration层包含JDBC、ORM、OXM、JMS和Transaction模块。
- JDBC模块提供了一个JDBC抽象层，它可以消除冗长的JDBC编码和解析数据库厂商特有的错误代码。这个模块包含了Spring对JDBC数据访问进行封装的所有类。
- ORM模块为流行的对象-关系映射API，如JPA、JDO、Hibernate、iBatis等，提供了一个交互层。利用ORM封装包，可以混合使用所有Spring提供的特性进行O/R映射，如前边提到的简单声明性事务管理。
Spring框架插入了若干个ORM框架，从而提供了ORM的对象关系工具，其中包括JDO、Hibernate和iBatisSQL Map。所有这些都遵从Spring的通用事务和DAO异常层次结构。
OXM模块提供了一个对Object/XML映射实现的抽象层，Object/XML映射实现包括JAXB、Castor、XMLBeans、JiBX和XStream。
JMS（Java Messaging Service）模块主要包含了一些制造和消费消息的特性。
Transaction模块支持编程和声明性的事务管理，这些事务类必须实现特定的接口，并且对所有的POJO都适用。
### Web
Web上下文模块建立在应用程序上下文模块之上，为基于Web的应用程序提供了上下文。所以，Spring框架支持与Jakarta Struts的集成。Web模块还简化了处理大部分请求以及将请求参数绑定到域对象的工作。Web层包含了Web、Web-Servlet、Web-Struts和Web-Porlet模块，具体说明如下。
Web模块：提供了基础的面向Web的集成特性。例如，多文件上传、使用servlet listeners初始化IoC容器以及一个面向Web的应用上下文。它还包含Spring远程支持中Web的相关部分。
Web-Servlet模块web.servlet.jar：该模块包含Spring的model-view-controller（MVC）实现。Spring的MVC框架使得模型范围内的代码和web forms之间能够清楚地分离开来，并与Spring框架的其他特性集成在一起。
Web-Struts模块：该模块提供了对Struts的支持，使得类在Spring应用中能够与一个典型的Struts Web层集成在一起。注意，该支持在Spring 3.0中已被弃用。
Web-Porlet模块：提供了用于Portlet环境和Web-Servlet模块的MVC的实现。
### AOP
AOP模块提供了一个符合AOP联盟标准的面向切面编程的实现，它让你可以定义例如方法拦截器和切点，从而将逻辑代码分开，降低它们之间的耦合性。利用source-level的元数据功能，还可以将各种行为信息合并到你的代码中，这有点像.Net技术中的attribute概念。
通过配置管理特性，Spring AOP模块直接将面向切面的编程功能集成到了Spring框架中，所以可以很容易地使Spring框架管理的任何对象支持AOP。Spring AOP模块为基于Spring的应用程序中的对象提供了事务管理服务。通过使用Spring AOP，不用依赖EJB组件，就可以将声明性事务管理集成到应用程序中。
Aspects模块提供了对AspectJ的集成支持。
Instrumentation模块提供了class instrumentation支持和classloader实现，使得可以在特定的应用服务器上使用。
### Test
Test模块支持使用JUnit和TestNG对Spring组件进行测试。

## Spring的领域模型
Spring的领域模型有三种，如下所述。
- 容器领域模型（Context模型）：也叫作上下文模型，是 Spring的掌控域，对 Spring核心领域模型进行生命周期管理。也可以将其称为Spring的服务域，因为它为整个应用服务。
- 核心领域模型（Bean模型）：体现了 Spring的一个核心理念，即“一切皆 Bean,Bean即一切”。Bean是应用运行时可执行的最小函数式单元，可以是一个属性单元，也可以是 Java 中的一个函数对象，更倾向于一种对象式的为某种特殊行为而生的可复用的概念，不受职责或者大小的限制。例如 Spring 上下文是一个 Bean，一个简单的描述型的对象也是一个Bean。Bean模型是Spring的核心服务实体域，是应用要操作的本身，是每个线程的真正执行者，也是整个会话生命周期的管理者，还是Spring对外暴露的核心实体。
- 代理领域模型（Advisor模型）:Spring代理的执行依赖于Bean模型，但是Spring代理的生成、执行及选择都依赖于 Spring自身定义的 Advisor模型，只有符合 Advisor模型的定义，才能生成Spring代理。


## 模块介绍
### 核心模块
- spring-core：依赖注入DI与IOC的最基本实现
- spring-beans：spring所有的bean工厂以及bean的装备都在这里面完成
- spring-context：定义基础的spring的Context上下文也就是IOC容器
- spring-context-support：对spring IOC容器的扩展支持，以及IOC的子容器
- spring-context-indexer：spring的类管理组件和对classpath扫描，类加载路径的管理
- spring-expression：包含spring中所有的表达式语言

### 切面编程

- spring-aop：面向切面编程的应用模块，整合Asm、cglib、jdkProxy
- spring-aspects：集成AspectJ、Aop应用框架
- spring-instrument： 动态class loading 模块，扫描类文件并加载类文件

### 数据访问与集成

- spring-jdbc：spring提供的jdbc抽象框架的主要实现模块，用于简化spring jdbc操作
- spring-tx：spring jdbc事务控制实现模块
- spring-orm：主要集成hibernate、jpa(java persistence api)、jdo(java data objects)
- spring-oxm：将Java对象映射成xml数据，或者xml转换成java对象
- spring-jms：java messaging service 进行消息的发送与接收

### web组件

- spring-web：提供了最基础的web支持，主要建立于核心容器之上，通过servlet或者listeners来初始化ioc容器
- spring-webmvc：实现了spring mvc 的web应用
- spring-websocket：主要是与web前端的全双工通讯协议
- spring-webflux：一个新的非堵塞函数式reactive web 框架，可以用来建立异步的，非堵塞的事件驱动服务

### 通信报文

- spring-messaging：spring4以后新加入的一个模块，主要负责spring框架集成一些基础的报文传送应用

### 集成测试

- spring-test：主要为测试提供支持

### 集成兼容

- spring-framework-bom：Bill of Materials，解决spring的不同模块依赖版本不同的问题