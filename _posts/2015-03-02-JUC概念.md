---
layout: post
categories: JUC
description: none
keywords: JUC
---
# JUC概念
要理解高并发编程，必须要深刻理解相关的概念。要理解什么是进程和线程？什么是并发和并行。我们为什么需要多线程？

## 并发编程概念

### 程序(Program)

- **程序(Program)**：是为完成特定任务、用某种语言编写的一组指令的集合。即指一段静态的代码。  

我们引用Wikipedia对计算机程序的定义：
```text
A computer program is a collection of instructions that performs a specific task when executed by a computer.
```
翻译成大白话就是，能指挥计算机干活的一堆指令就叫计算机程序。

### 进程(Process)

- **进程(process)**：程序的一次执行过程，或是正在运行的一个程序。  

进程是操作系统进行资源分配的最小单位。一个进程是一个程序的一次执行过程。每启动一个进程，操作系统就会为它分配一块独立的内存空间，用于存储PCB、数据段、程序段等资源。 每个进程占有一块独立的内存空间。
进程就是一个程序的执行实例，也就是正在执行的程序。在OS的眼里，进程就是一个担当分配系统资源CPU时间、内存的实体。

### 线程(Thread)

- **线程(thread)**：进程可进一步细化为线程，是一个程序内部的一条执行路径。线程作为CPU调度和执行的单位，每个线程拥独立的运行栈和程序计数器(pc)，线程切换的开销小。 

线程是操作系统能够进行运算调度的最小单位。它被包含在进程之中，是进程中的实际运作单位。一条线程指的是进程中一个单一顺序的控制流，一个进程中可以并发多个线程，每条线程并行执行不同的任务。
同一进程中的多条线程将共享该进程中的全部系统资源，如虚拟地址空间，文件描述符和信号处理等等。但同一进程中的多个线程有各自的调用栈（call stack），自己的寄存器环境（register context），自己的线程本地存储（thread-local storage）。

### 同步（Synchronous）和异步（Asynchronous）

- **同步（Synchronous）**：同步，就是在发出一个功能调用时，在没有得到结果之前，该调用就不返回。  
- **异步（Asynchronous）**：异步的概念和同步相对。当一个异步过程调用发出后，调用者不能立刻得到结果。实际处理这个调用的部件在完成后，通过状态、通知和回调来通知调用者。  
比方说：你去商城买东西，你看上了一款手机，能和店家说你一个这款手机，他就去仓库拿货，你得在店里等着，不能离开，这叫做同步。
  现在你买手机赶时髦直接去京东下单，下单完成后你就可用做其他时间（追剧、打王者、lol）等货到了去签收就ok了.这就叫异步。
  
### 并发（Concurrency）和并行（Parallelism）

- **并发（Concurrency）**：在**一个时间段内**，多件事情在这个时间段内**交替执行**。
- **并行（Parallelism）**：多件事情在**同一个时刻**同事发生。
从严格意义上来说，并行的多任务是真的同时执行，而对于并发来说，这个过程只是交替的，一会执行任务A，一会执行任务B，系统会不停地在两者之间切换。但对于外部观察者来说，即使多个任务之间是串行并发的，也会造成多任务间并行执行的错觉。  
实际上，如果系统内只有一个CPU，而使用多进程或者多线程任务，那么真实环境中这些任务不可能是真实并行的，毕竟一个CPU一次只能执行一条指令，在这种情况下多进程或者多线程就是并发的，而不是并行的（操作系统会不停地切换多任务）。真实的并行也只可能出现在拥有多个CPU的系统中（比如多核CPU）。  
比如说：大家排队在一个饮水机上接水，交替执行，是并发；两台饮水机上面接水，是并行。
  
### 临界区

临界区用来表示一种公共资源或者说共享数据，可以被多个线程使用，但是每一次只能有一个线程使用它，一旦临界区资源被占用，其他线程要想使用这个资源就必须等待。  
比如，一个办公室里有一台打印机，打印机一次只能执行一个任务。如果小王和小明同时需要打印文件，很明显，如果小王先发了打印任务，打印机就开始打印小王的文件，小明的任务就只能等待小王打印结束后才能打印，这里的打印机就是一个临界区的例子。  
在并行程序中，临界区资源是保护的对象，如果意外出现打印机同时执行两个任务的情况，那么最有可能的结果就是打印出来的文件是损坏的文件，它既不是小王想要的，也不是小明想要的。  

### 阻塞（Blocking）和非阻塞（Non-Blocking）

阻塞和非阻塞通常用来形容很多线程间的相互影响。比如一个线程占用了临界区资源，那么其他所有需要这个资源的线程就必须在这个临界区中等待。等待会导致线程挂起，这种情况就是阻塞。此时，如果占用资源的线程一直不愿意释放资源，那么其他线程阻塞在这个临界区上的线程都不能工作。

非阻塞的意思与之相反，它强调没有一个线程可以妨碍其他线程执行，所有的线程都会尝试不断向前执行。

### 死锁（Deadlock）、饥饿（Starvation）和活锁（Livelock）


