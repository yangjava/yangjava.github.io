---
layout: post
categories: [C]
description: none
keywords: C
---
# C基本语法
语法是一门编程语言的核心，只有掌握了语法之后，才能编写出合法的程序语句，完成项目的要求。

程序可以完成各种各样的任务，而这些任务的执行依赖于许许多多用于含有存储任务信息的数据。这些数据含有的信息也是执行程序的基础。在C程序中，使用常量和变量两种形式来存储和表示数值。为了保存各种不同的数据，C语言中定义了一系列的数据类型。

C语言的基本语法知识。
- 标识符和关键字
- 最基本的数据类型
- 常量和变量的深入理解
- 整型数据
- 实型数据
- 字符型数据
- 初始化变量
- 整型、实型和字符型数据间的运算总结

## 标识符
标识符是在C语言中用来标识唯一的对象的符号。具体地说，就是各种名称，如变量的名称、常量的名称、函数的名称、数据类型的名称、命令的名称等。

在C语言中，除了库函数的函数名由系统定义外，其余都是由用户自定义的。C语言规定，标识符只能是字母（A～Z。a～z）、数字（0～9）、下划线（_）组成的字符串，并且其第一个字符必须是字母或下划线。

标识符的第一个字符必须是字母或下画线（_），后跟字母、下画线或数字。标识符中区别大小写字母，如average、aVerage、AVERAGE和AVeraGE是4个不同的标识符，可以同时在C程序中作为不同含义使用。

例如下面的标识符都是合法的。
```c
a
x
_3x
BOOK_1
sum5
```
而下面的标识符是非法的。
```c
3s　　　　 　　以数字开头
s*T　　 　　　出现非法字符*
-3x　　　　 　　以减号开头
bowy-1　　　　出现非法字符-(减号)
```
使用标识符时必须注意以下几点。
- 标准C不限制标识符的长度，但它受各种版本的C语言编译系统限制，同时也受到具体机器的限制。例如在某版本C中规定标识符前8位有效，当两个标识符前8位相同时，则被认为是同一个标识符。
- 在标识符中，大小写是有区别的。例如BOOK和book是两个不同的标识符。
- 标识符虽然可由程序员随意定义，但标识符是用于标识某个量的符号，因此，命名应尽量有相应的意义，以便阅读理解，作到“顾名思义”。
- 所有标识符必须由一个字母（a～z、A～Z）或下划线（_）开头。
- 标识符的其他部分可以用字母、下划线或数字（0～9）组成。
- 标识符只有前32个字符有效。
- 标识符不能使用C语言的关键字。

## 关键字
关键字也是标识符。关键字是由C语言规定的具有特定意义的字符串，通常也称为保留字。用户定义的标识符不应与关键字相同。

关键字是C语言定义的一些有特殊意义的字符串，是为C编译器专门保留的，因此，也称为保留字。关键字是C语言的重要组成部分。

事实上，学习C语言的过程就是学习关键字的过程，只要掌握每一个关键字的含义和使用方法，就掌握了C语言编程。

C99中定义了37个关键字，每一个都有特殊的含义，但是并不是所有的编译器都支持这些关键字。

C语言的关键字可以分为以下3类。
- 类型说明符：用于定义、说明变量、函数或其他数据结构的类型。
- 语句定义符：用于表示一个语句的功能。如例1.3中用到的if else就是条件语句的语句定义符。
- 预处理命令字：用于表示一个预处理命令。如前面各例中用到的include。

由于关键字具有特殊的含义，因此，程序员不能使用这些字符串作为变量名和函数名。如果在程序中使用关键字作为变量名或函数名，编译器会对这些行为报错。但是，除了这些关键字外，C语言中还有其他一些保留字，比如，预处理命令中用于包含文件的字符串include和主函数名main，以及一些标准函数库的函数名，如printf。这些都是C语言的保留字符，由于它们在C语言中都有特殊含义，使用它们会导致一些编程隐患，因此，应该避免使用这些字符串。

类型说明符关键字（12个）：
- char [tɑ:]：声明字符型变量或函数
- double [dbl] ：声明双精度变量或函数
- enum ：声明枚举类型
- float [flut] ：声明浮点型变量或函数
- int[int]： 声明整型变量或函数
- long [l] ：声明长整型变量或函数
- short [:t] ：声明短整型变量或函数
- signed：声明有符号类型变量或函数
- struct：声明结构体变量或函数
- union [ju:nin]：声明共用体（联合）数据类型
- unsigned [n'saind]：声明无符号类型变量或函数
- void [vid] ：声明函数无返回值或无参数，声明无类型指针（基本上就这三个作用）

控制语句关键字（12个）：

循环语句
- for [f, f:]：一种循环语句
- do [du, du:] ：循环语句的循环体
- while [wail] ：循环语句的循环条件
- break [breik]：跳出当前循环
- continue[kntinju:]：结束当前循环，开始下一轮循环

条件语句
- if [if]: 条件语句
- else [els] ：条件语句否定分支（与 if 连用）
- goto：无条件跳转语句

C开关语句
- switch [swit]:用于开关语句
- case [keis]：开关语句分支
- default [dif:lt]：开关语句中的“其他”分支

返回语句
- return [rit:n]：子程序返回语句（可以带参数，也看不带参数）

存储类型关键字（4个）
- auto [:tu] ：声明自动变量（一般不使用）
- extern：声明变量是在其他文件正声明（也可以看做是引用变量）
- register [redist]：声明积存器变量
- static[sttik] ：声明静态变量

其它关键字（4个）：
- const ：声明只读变量 （*注意是变量*）
- sizeof：计算数据类型长度
- typedef：用以给数据类型取别名（当然还有其他作用）
- volatile [vltail]：说明变量在程序执行中可被隐含地改变

C99新增（5个）
- inline关键字用来定义一个类的内联函数，引入它的主要原因是用它替代C中表达式形式的宏定义
引入原因：C语言是一个效率很高的语言，这种宏定义在形式及使用上像一个函数，但它使用预处理器实现，没有了参数压栈，代码生成等一系列的操作
- restrict关键字只用于限定指针；该关键字用于告知编译器，所有修改该指针所指向内容的操作全部都是基于(base on)该指针的，即不存在其它进行修改操作的途径；这样的后果是帮助编译器进行更好的代码优化，生成更有效率的汇编代码。
- _Bool关键字是用于表示布尔值。包含标准头文件 stdbool.h 后，我们可以用 bool 代替 _Bool ，true 代替 1 ，false 代替 0 。
- _Complexand_Imaginary关键字
C99标准中定义的复数类型如下：float_Complex; float_Imaginary; double_Complex; double_Imaginary; long double_Complex; long double_Imaginary.

头文件中定义了complex和imaginary宏,并将它们扩展为_Complex和_Imaginary,因此在编写新的应用程序时,应该使用头文件中的complex和imaginary宏。

## 变量与常数
计算机主要的功能就是强大的运算能力，基本过程就是将从外界得到的数据输入计算机，并通过程序来进行运算，最后输出所要的结果。当程序运行时，外界的数据进入计算机后要有个栖身之处，这时系统会分配一个内存空间给这份数据。在程序代码中，我们所定义的变量（Variable）与常数（Constant）扮演的就是这样的角色。

变量与常数主要用来存储程序中的数据，以便程序进行各种运算。无论是变量还是常数，必须事先声明一个对应的数据类型（data type），并在内存中保留一块区域供其使用。两者之间最大的差别在于变量的值是可以改变的，而常数的值是固定不变的。

我们可以把计算机的主存储器（内存）想象成一个豪华旅馆、外部数据当成来住房的旅客，旅馆的房间有不同的等级，就像属于不同的数据类型，最贵的等级价格自然高，不过房间也较大，就像有些数据类型所占内存空间的字节数较多。

定义变量就像向C系统要房间，这个房间的房号就是内存中的地址，房间的等级就是数据的类型，当然这个房间的客人是可以变动的。而常数就像是被长期租用的房间，不可以再变更住客，除非这个程序运行结束。

## 认识变量
变量是程序设计语言中不可或缺的部分，代表可变更数据的内存空间。变量声明的作用在于告知计算机所声明的变量需要多少内存空间。C语言属于一种强类型（strongly typed）语言，当声明变量时，必须以数据类型作为声明变量的依据，同时要设好变量的名称。

简单地看，变量由两部分组成：变量名和变量值。变量名是一个标识符；变量值是一个数据值。

在C语言中，便可以使用变量名来表示变量值。所谓“变量就是指可以改变的量”，就是指其变量值是可以改变的。

程序为每个变量都分配一个存储空间，其数据值存储在该空间内。程序可以使用变量名来访问这个存储空间，通过读取和修改该空间的内容来实现访问和修改该变量。变量的引入为程序对数据的处理提供了很大的便利。

基本上，变量具备4个形成要素
- 名称：变量在程序中的名字，必须符合C语言中标识符的命名规则及可读性。
- 值：程序中变量所赋予的值。
- 引用位置：变量在内存中存储的位置。
- 属性：变量在程序中的数据类型，如整数、浮点数或字符。

## 变量命名原则
在C语言的程序代码中所看到的代号，通常不是标识符（IDentifier）就是关键字（Keyword）。

在真实世界中，每个人、事及物都有一个名称，程序设计也不例外，标识符包括变量、常数、函数、结构、联合、枚举等代号（由英文大小写字母、数字或下划线组合而成），例如helloworld范例中的no、printf、system都属于标识符。

至于关键字，就是具有语法功能的保留字，所有程序员自行定义的标识符都不能与关键字相同，在ANSI C中共定义了32个关键字。

基本上，变量名称都是由程序设计者自行定义的，为了考虑程序的可读性，大家最好以符合变量赋予的功能与意义来给变量命名，例如总和取名为“sum”、薪资取名为“salary”等，程序规模越大越重要。

变量属于标识符的一种，必须遵守以下基本规则：
- 变量名称开头可以是英文字母或下划线，但不可以是数字，名称中间也不可以有空白。
- 变量名称中间可以有下划线，例如int_age，但是不可以使用-、*、$、@、…等符号。
- 变量名称长度不可超过127个字符，另外根据ANSI C标准（C99标准），只有前面63个字符被视为变量的有效名称，后面的64个字符会被舍弃。
- 变量名称必须区分字母的大小写，例如Tom与TOM会视为两个不同的变量。
- 不可使用关键字（Keyword）或与内建函数名称相同的名字。

为了程序可读性，建议对于一般变量进行声明时以小写字母开头，例如name、address等，而常数最好以大写字母开头并配合“_”（下划线），如PI、MAX_SIZE。

至于函数名称，习惯以小写字母开头，如果由多个英文单词组成，那么其他英文单词的开头字母为大写，如copyWord、calSalary等。

下面这个范例演示了使用变量来访问数据的便利。
```
  #include <stdio.h>
 
  int main(void) {
    int data = 24;                         /* 定义变量data */
    printf("data = %d\n", data + 1);       /* 访问变量data */
    data = 26;                             /* 修改变量值 */
    printf("data = %d\n", data);           /* 访问变量data */
    return 0;
  }
```
本程序定义了一个变量名为data的变量，其值为24。假定为其分配的内存空间的地址为0016。

可以使用data来获得分配给变量data空间的值；也可以直接使用data来改变分配给变量data空间中存储的值。

## 变量的声明
相对常量单一的使用方法而言，变量的使用必须依照一定的规则进行。要使用一个变量，首先要声明和定义这个变量，然后才能使用它来表示数据。此外，还可以对变量进行多次赋值，其中，第一次赋值行为被称为对变量的初始化。

由于变量的值可以改变，因此不同数据类型的变量所使用的内存空间大小以及可表示的数据范围有所不同。在程序设计语言中，有关变量存储地址的方法有两种
- 静态内存分配
静态内存分配法变量内存分配的过程是在程序编译时(ComPihng Time)进行的，如 C/C++、Pascal 语言等。在编译时确定变量的类型称为“静态检查”(static Checking), 变量的类型与名称在编译时确定
- 动态内存分配
变量内存分配的过程是在程序运行时(Running Time)进行的，如BASIC、Lisp 语言等。运行时才’确定变量的类型称为“动态检查”(Dynamic Checking), 变量的类型与名称可在运行时随时改变 

由于C语言属于“静态内存分配”（Static Storage Allocation，或称为静态存储器分配）的程序设计语言，必须在编译时分配内存空间给变量，因此C语言的变量必须先声明再使用。

声明一个变量，实际上是以特定的格式声明一个标识符，其作用是告诉编译器与标识符相关联的一些属性。正确的变量声明由数据类型加上变量名称与分号构成，语法如下：
```
数据类型 变量名称1, 变量名称2, …… , 变量名称n;
变量名称1=初始值1;
变量名称2=初始值2;
……
```

我们知道在C语言中共有整数（int）、浮点数（float）、双精度浮点数（double）以及字符（char）四种基本数据类型可用于变量声明

例如，声明整数类型的变量var1如下：
```
int var1;
var1=100;
```
以上这两行程序代码类似于我们到餐厅订位，先预定var1的位置（具有4个字节的整数空间），但是不确定这个地址上的数值是什么，只是先把它保留下来。如果变量设置初始值为100，就会将100放入这4个字节的整数空间。

使用未声明的标识符
```
  #include <stdio.h>
 
  int main(void) {
    printf("data = %d\n", data);       /* 输出data的值 */
    return 0;
}
```
编译器在编译时会报错，信息如下：
```
.\3-3.c(4) : error C2065: 'data' : undeclared identifier
```
使用了标识符data。由于它未被声明，而且又不是编译器自定义的标识符，编译器无法知道这个标识符代表的意思，因此，编译器将出现错误提示。

在声明变量的同时可自行决定是否要赋予初值。如果尚未设置初值就直接输出变量的内容，通常会打印出无法预料的数字。
```
#include <stdio.h>
#include <stdlib.h>
  
int main()
{
    int a;
    int b=12;
    float _c=117.12345;
    
    printf("变量a=%d\n",a); /*打印出未初始化的a值*/
    printf("变量b=%d\n",b); /*打印出已初始化的b值*/
    printf("变量_c=%f\n",_c);/*打印出已初始化的_c值*/
    
    system("pause");
    return 0;
}
```
- 声明了3个变量，其中a变量并未设置初始值。
- 输出a时会在屏幕上发现a=0。若显示的不是0也很正常，因为系统并未清除原先地址上的内容或值，出现的是先前存放的数值。因此，建议在声明变量后最好能同时设置初始值。

以上示范是声明变量后再设置值，当然也可以在声明时同步设置初值，语法如下：
```
数据类型 变量名称1=初始值1;
数据类型 变量名称2=初始值2;
数据类型 变量名称3=初始值3;
…
```
例如，声明两个整数变量num1、num2，其中int为C语言中整数声明的关键字：
```
int num1=30;
int num2=77；
```
这时C语言会分别自动分配4个字节的内存空间给变量num1和num2，它们的存储值分别为30和77。当程序运行过程中需要存取这块内存时，就可以直接使用变量名称num1与num2进行存取

如果要一次声明多个相同数据类型的变量，可以使用“,”隔开变量名称。为了养成良好的编写程序习惯，变量声明部分最好放在程序代码的开头，也就是紧接在“{”符号后声明（如main函数或其他函数）。例如：
```
int a,b,c; 
int total =5000; /* int为声明整数的关键字 */
float x,y,z;
int month, year=2003, day=10;
```

## 定义变量
定义变量的主要作用是为语句中的标识符代表的变量分配一块内存。其形式与变量声明基本一致，如下所示：
```
数据类型名 变量名;
```
变量定义包括变量声明，但比变量声明多了一个分号。其意义为：变量定义是一个完整的语句，是在运行期才能起作用的，而变量声明则在编译期就起作用。也可以理解为，变量定义完成两个功能：第一，声明变量；第二，为变量分配内存空间。第一个功能是为编译期服务的，而第二个功能是在运行期完成的。

在使用变量前，必须有定义语句为变量分配内存。一般情况下，只要将变量定义语句放在使用语句之前即可。首先，由于变量的定义完成了声明作为变量的标识符的功能，因此，在变量定义语句之后便可使用该变量名；其次，变量的定义还为该变量分配了空间，因此，在变量定义语句之后使用该变量才能访问到对应的内存空间。

## 使用extern声明变量
变量使用之前必须先定义。一般情况下，都会在变量定义语句之后才使用变量，若一定要在变量定义语句之前使用变量，也必须借助关键字extern来声明变量。

使用extern声明变量的形式如下。
```
extern 数据类型名 变量名；
```
extern语句的作用是，告诉语句该变量是在该程序的其他程序块完成定义的。

下面是几个使用extern声明变量的例子：
```
extern int key;
extern double score;
extern char ppt;
```
上述语句声明了key为int型变量，score为double型变量，ppt为char型变量。程序运行中使用变量名访问变量内存时，会先根据它的声明来查找相应的定义语句。

由于变量名是唯一的，因此，只需变量名即可查找到其定义。所以C语言也接受缺少数据类型名的extern声明语句，例如：
```
extern key;
extern score;
extern ppt;
```
但是这是不好的使用习惯。使用extern语句声明变量时，一定要写上数据类型。缺少数据类型的做法会使阅读程序的人无法马上获得变量的数据类型信息，从而降低了程序的可读性。

使用extern语句声明变量，实现方法如示例代码
```
  #include <stdio.h>
 
  int main(void) {
    extern int data;                /* 声明一个变量data */
    printf("data = %d\n", data);    /* 输出data的值 */
    return 0;
  }
  
   int data = 23;                       /* 定义变量data */
```
由于变量data的定义语句在`int data = 23;`，而第前面便使用了data变量。因此，在之前需要使用extern语句声明变量`extern int data`。


## 变量的作用域
变量除了有可变动的特性，在程序中不同的位置声明也会有不同的生命周期。我们知道语句（statement，或称为指令）是C语言最基本的执行单位，每一行语句都必须加上“;”作为结束。
在C程序中，可以使用“{}”将多个语句包围起来，形式如下：
```
{
  程序语句；
  程序语句；
  程序语句；
}
```
以上程序代码以大括号“包围”的多行语句称为程序区块（statement block，或称为语句区块）。变量作用域（或称变量的有效范围）是根据变量所在的位置决定的，也就是用来判断在程序中有哪些程序区块中的语句（Statement）可以合法使用这个变量。在C语言中，变量的作用域通常可分为三个层次：全局变量（Global Variable）、局部变量（Local Variable）与区块变量（Block Variable）。

## 全局变量
全局变量是指在主函数main()外声明的变量，在整个程序中任何位置的语句都可以合法使用这种变量。简单来说，声明在程序区块与函数外，且在声明语句以下的所有函数和程序区块都可以使用全局变量。通常全局变量用来定义一些不会经常改变的数值，不过初学者不应该为了方便而将所有变量都设置为全局变量，否则将来会发生变量名称管理上的问题，全局变量的生命周期始于程序开始之时，终于程序运行结束之后。

```
float pi=3.14; /* pi是全局变量 */

int main()
{
…
  …
}
```

## 局部变量
局部变量是指在函数内声明的变量，或者声明在参数行中的变量，作用域只在声明的函数区块中，其他函数不可以使用这种变量。局部变量的生命周期开始于函数被调用之后，终止于该函数运行完毕之时。
```
void circle()
{
 float pi=3.14; /* pi是circle()函数中的局部变量 */
}
int main()
{
…
  …
}
```

## 区块变量
区块变量是指在某个程序区块中声明的变量，也是局部变量的一种，不过作用域更小。在某些程序代码区块中声明的变量有效范围仅在此区块中，此程序区块以外的程序代码都不能使用这个变量。
```
{
   /*在此区块中声明一个变量sum，有效范围仅在此“程序区块”内*/
   int sum ;  
   ...
}
```

在这个范例程序中，我们在不同的位置声明salary变量，这个变量的生命周期有不同的意义，尤其当区块变量与全局变量同名时，以区块变量优先，大家可以仔细观察与比较。不过全局变量与区块变量同名很容易引起混淆，影响程序的可读性，大家在编写程序时最好避免这种情况。
```
01  #include<stdio.h>
02  #include<stdlib.h>
03  
04  int salary=17500;/* 声明salary为全局变量 */ 
05  
06  int main()
07  {
08    
09    printf("salary=%d\n",salary);
10    {
11     int salary=22000;/* 在此声明salary为区块变量 */ 
12     printf("salary=%d\n",salary);
13    }
14    printf("salary=%d\n",salary);
15     
16    system("pause");
17    return 0;
18  }
```
- 第4行：声明salary为全局变量，在整个程序中任何位置的语句都可以合法使用该变量。
- 第9行：输出全局变量salary的值。
- 第11行：声明salary为区块变量。
- 第12行：输出区块变量salary的值。
- 第14行：因为离开了程序区块，所以又将输出全局变量salary的值。

## 常数
前面谈的变量可以在程序运行过程中改变其值，常数在程序运行时会固定不变。例如，10、-568、0、5000等是整数常数，3.1416、0.001、82.51等是浮点数常数。如果是字符常数，就必须以单引号“''”括住字符（如'a''c'）；如果数据类型为字符串，就必须以双引号“""”括住字符串，例如"程序设计""Happy Birthday"等。

## 常数命名规则
常数在程序中的应用也和变量一样，可以用一个标识符来表示，唯一的不同之处在于这个标识符所代表的数据值在此程序运行时是绝对无法改变的。例如，一个计算圆面积的程序，其中的PI值就可以使用常数标识符来表示。

通常有两种定义方式，标识符的命名规则与变量相同，习惯上会以大写英文字母来定义名称。这样不但可以增加程序的可读性，而且对程序的调试与维护有帮助。

### #define常数名称常数值
使用宏指令#define来声明。所谓宏（Macro），又称为“替换指令”，主要功能是以简单的名称取代某些特定常数、字符串或函数，善用宏可以节省不少程序开发的时间。由于#define为一种宏指令，并不是赋值语句，因此不用加上“=”与“;”。例如，定义常数的方式如下：
```
#define　PI　3.14159
```
当使用#define定义常数时，程序会在编译前先调用宏处理程序（Macro Processor），用宏的内容来取代所定义的标识符，然后进行编译的操作。简单来说，就是将程序中所有PI出现的部分都替换成3.14159，这就是使用宏指令的特点。

下面的范例程序说明如何以#define形式声明常数。与一般的指令不同，无须声明标识符的数据类型和使用“=”赋值符号，通常是将其加在程序最前端的预处理指令区。
````
01  #include<stdio.h>
02  #include<stdlib.h>
03  
04  #define PI 3.14159  /*声明PI为3.14159*/ 
05  
06  int main()
07  {  
08         
09      float radius =5.0,Area; /*声明与设置圆半径 */    
10      
11      Area=radius*radius*PI;  /* 计算圆面积 */  
12      
13      printf("圆的半径为=%f ,面积为=%f \n",radius,Area);    
14      
15      system("pause");  
16      return 0;
17  }
````
- 第4行：使用#define声明PI为3.14159，声明后程序中所有出现PI的部分都代表常数值3.14159，指令结束时也不用加分号。
- 第11行：计算圆面积的公式。

### const数据类型常数名称=常数值;
使用const保留修饰词来声明与设置常数标识符名称之后的数值，其实还是将所声明的变量进行限制，即在运行中都无法改变其数值。如果声明时并未设置初值，之后也就不能设置数值了。使用const保留字定义常数的方式如下：
```
const float　PI=3.14159;
```
在下面的范例程序中，我们要特别说明，在使用#define来定义常数时，其生命周期一直到这个程序运行结束，或使用到取消定义（undefined）为止。而const所定义的常数还有其生命范围的问题，例如在main函数中声明了一个const类型的常数salary，但如果在函数程序区块中也声明了一个const类型的常数salary，就可以改变其值。请大家注意，如果第10行中把const int拿掉，只有salary=17500，即要修改由const声明后的变量值，那么在编译时就会出现报错的信息。
```
01  #include<stdio.h>
02  #include<stdlib.h>
03  
04  int main()
05  {
06    const int salary=25000;/* 声明salary为常数 */ 
07    
08    printf("salary=%d\n",salary);
09    {
10     const int salary=17500;/* 在此程序区块中声明salary为常数 */ 
11     printf("salary=%d\n",salary);
12    }
13    
14    printf("salary=%d\n",salary);
15      
16     system("pause");
17     return 0;
18  }
```
- 第6行：声明salary为常数。
- 第10行：在此程序区块中声明salary为常数。
- 第11、14行：这两行输出的salary值并不相同，一个为局部常数，一个为全局常数。

