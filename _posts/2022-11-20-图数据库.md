---
layout: post
categories: [JanusGraph]
description: none
keywords: JanusGraph
---
# 图数据库
图形数据库是 NoSQL 数据库的一种类型，它应用图形理论存储实体之间的关系信息。

## 图数据库简介
最常见的例子，就是社会网络中人与人之间的关系。关系型数据库用于存储关系型数据的效果并不好，其查询复杂、缓慢、超出预期，而图形数据库的独特设计恰恰弥补了这个缺陷。Google的图形计算系统名为 Pregel。

目前主流的图数据库有：Neo4j，FlockDB，GraphDB，InfiniteGraph，Titan，JanusGraph，Pregel等。

图是一种描述数据存储结构的方式，比如键值对结构，也是存储数据的一种方式，只是图结构更为复杂。图是由顶点和边组成的，点和边各自都可以包含任意多个键值对形式的属性
- 点是用来描述离散的对象，例如 人、地点、事件
- 边是对点之间关系的描述，例如，一个人可以认识另一个人、一个人参与了某件事、一个人在某个地方
- 属性描述了点和边的信息，例如，一个点包含属性：名称、年龄，一个边包含属性：时间戳

下面介绍几个图数据库中的几个基本概念：
- RDF
RDF(Resource Description Framework)，即资源描述框架，其本质是一个数据模型（Data Model）。它提供了一个统一的标准，用于描述实体/资源。简单来说，就是表示事物的一种方法和手段。RDF 形式上表示为 SPO 三元组，有时候也称为一条语句（statement），知识图谱中我们也称其为一条知识。RDF 由节点和边组成，节点表示实体/资源、属性，边则表示了实体和实体之间的关系以及实体和属性的关系。RDF 没有外键和主键，它使用的是 URI，万维网的标准引用格式。通过 URI，一个三元组库可以直接链接到任何三元组库的其他任何数据。
- 属性图
属性图是由 顶点（Vertex），边（Edge），标签（Lable），关系类型 还有 属性（Property）组成的有向图。顶点也称为 节点（Node），边也称为 关系（Relationship）。在图形中，节点和关系是最重要的实体；

- TinkerPop
TinkerPop是一种开源图计算框架，是 Apache 软件基金会旗下的一个顶级项目，该项目专注于为图数据库建立行业标准，包括一种名为Gremlin的标准语言（可跨语言）；

- Titan
Titan项目创建于2012年，于2016年停止维护，是一个方便拓展的图数据库，支持HBase、Cassandra 等作为后端，ES、Lucene 等做全文索引，以TinkerPop作为图的查询和计算框架；

- JanusGraph
JanusGraph 是 Titan 1.0.0版本的延续，JanusGraph继承了 Titan 的全部功能并做了进一步的改进，并支持 Hadoop 2和 Tinkerpop 3.2.3，采用 Gremlin 图查询语言；

- Neo4j
Neo4j 使用「图」这种最通用的数据结构来对数据进行建模，使得 Neo4j 的数据模型在表达能力上非常强。链表、树和散列表等数据结构都可以抽象成用图来表示。

## 图数据的发展趋势是什么？
图的本质难题是什么？是数据的高度关联带来的严重的随机访问。所以，传统的关系型数据库解决不了这个问题，因为他们仍然是面向磁盘优化，尽可能利用磁盘顺序读写的优势。neo4j这种数据结构在数据落到磁盘上的时候，随机访问比关系型数据库多更多，性能衰减想当厉害。那么分布式nosql的路子呢？网络是瓶颈。完美的最小割图分区算法是NP难题，而且在数据写入的情况下还要面临动态调整的难题。如果使用naive的分区算法，网络通讯的开销是想当大的。

所以，个人浅见，只有靠新硬件来解决问题。更廉价的大内存、NVRAM、RDMA高速网络、随机读写更强的SSD磁盘、有硬件事务支持的CPU等。

下面是常见的几种图查询语言：
- SPARQL
SPARQL这个名字是一个递归缩写，代表“SPARQL Protocol and RDF Query Language（SPARQL协议与RDF查询语言），它是面向RDF(Resource Description Framework)的三元组数据，W3C标准，无schema，在研究中应用非常广泛。SPARQL的查询与RDF是一致的，RDF是图，SPARQL查询是子图匹配。

- Gremlin 
数据以属性图的形式存在，可以认为是上面两种的混合体，属性仍然在表中，但是联接关系是直接以链接（比如指针）的形式存在的。查询的本质是图遍历，擅长解决求图的直径、点到点之间的路径，比如刘德华连接奥巴马需要几度关系。

- Cypher
Cypher是 Neo4j 专门用于图数据库的查询语言，类似于Oracle数据库的SQL语言，是一种声明式查询语言，只需要用户描述需要执行什么动作（match、insert等），而不需要描述具体怎么做，需要注意的是，只有在商业版中，Cypher的查询语句编译器才会生成高性能的查询动作。

例1：查询所有城市类型为「Capital」的城市列表/URL
- Cypher：
```
match(n:Capital)
return n;
```
- SPARQL
```
PREFIX rdf：< http://www.w3.org/2018/11/22-rdf-syntax-ns#>
SELECT * WHERE {
  ？city rdf：type < http://abc.org/Capital >
```
- Gremlin:
```
g.V().hasLabel("Capital").values()
```

















