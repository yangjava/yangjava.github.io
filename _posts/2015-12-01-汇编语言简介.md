---
layout: post
categories: Assembly
description: none
keywords: Assembly
---
# 汇编语言简介
《汇编语言》(Assembly Language)是计算机专业中一门重要的基础课程，是一种面向机器的低级语言。它依赖于硬件，能通过巧妙的程序设计充分发挥硬件的潜力。汇编语言程序产生的代码运行效率高。因此，到目前为止，许多软件系统(例如操作系统等)的核心部分仍然用汇编语言来编写。

## 汇编语言的由来

汇编语言是直接在硬件上工作的编程语言，首先要了解硬件系统的结构，才能有效的应用汇编语言对其编程。
### 机器语言
机器指令是CPU能直接识别并执行的指令，它的表现形式是二进制编码。机器指令通常由操作码和操作数两部分组成，操作码指出该指令所要完成的操作，即指令的功能，操作数指出参与运算的对象，以及运算结果所存放的位置等。

由于机器指令与CPU紧密相关，所以，不同种类的CPU所对应的机器指令也就不同，而且它们的指令系统往往相差很大。但对同一系列的CPU来说，为了满足各型号之间具有良好的兼容性，要做到：新一代CPU的指令系统必须包括先前同系列CPU的指令系统。只有这样，先前开发出来的各类程序在新一代CPU上才能正常运行。

机器语言是用来直接描述机器指令、使用机器指令的规则等。它是CPU能直接识别的唯一一种语言，也就是说，CPU能直接执行用机器语言描述的程序。

用机器语言编写程序是早期经过严格训练的专业技术人员的工作，普通的程序员一般难以胜任，而且用机器语言编写的程序不易读、出错率高、难以维护，也不能直观地反映用计算机解决问题的基本思路。

由于用机器语言编写程序有以上诸多的不便，现在几乎没有程序员这样编写程序了。

### 汇编语言

虽然用机器语言编写程序有很高的要求和许多不便，但编写出来的程序执行效率高，CPU严格按照程序员的要求去做，没有多余的额外操作。所以，在保留“程序执行效率高”的前提下，人们就开始着手研究一种能大大改善程序可读性的编程方法。

为了改善机器指令的可读性，选用了一些能反映机器指令功能的单词或词组来代表该机器指令，而不再关心机器指令的具体二进制编码。与此同时，也把CPU内部的各种资源符号化，使用该符号名也等于引用了该具体的物理资源。

如此一来，令人难懂的二进制机器指令就可以用通俗易懂的、具有一定含义的符号指令来表示了，于是，汇编语言就有了雏型。现在，我们称这些具有一定含义的符号为助忆符，用指令助忆符、符号地址等组成的符号指令称为汇编格式指令(或汇编指令)。

汇编语言是汇编指令集、伪指令集和使用它们规则的统称。伪指令是在程序设计时所需要的一些辅助性说明指令，它不对应具体的机器指令，有关内容在以后的各章节中会有详细叙述，在此不展开介绍。

用汇编语言编写的程序称为汇编语言程序，或汇编语言源程序，在本教材中或特定的环境下，也可简称为源程序。汇编语言程序要比用机器指令编写的程序容易理解和维护。


### 汇编程序
用汇编语言编写的程序大大提高了程序的可读性，但失去了CPU能直接识别的特性。例如用汇编语言书写的指令：MOV AX, BX，CPU不会知道这几个字符所表达出来的功能，但程序员一看就知道：要求CPU把寄存器BX的值传送给寄存器AX。

把机器指令符号化增加了程序的可读性，但引起了如何让CPU知道程序员的用意，并按照其要求完成相应操作的问题。解决该问题就需要一个翻译程序，它能把汇编语言编写的源程序翻译成CPU能识别的机器指令序列。这里，我们称该翻译程序为汇编程序。

汇编程序翻译过程的示意图
```text
MOV AX, BX                  89D8H
                 ===>
ADD AX, 5                   050500H
```

从图中不难看出：汇编程序能把左边汇编语言源程序翻译成右边的机器指令序列。其中，把汇编语言指令“MOV AX, BX”和“ADD AX, 5”分别转换成机器指令89D8H和050500H，而后者都是CPU能直接识别的，所以，可执行它们。

目前，常用的汇编程序有：MASM、TASM和DEBUG等。


## 汇编语言的主要特点

一方面，汇编语言指令是用一些具有相应含义的助忆符来表达的，所以，它要比机器语言容易掌握和运用，但另一方面，它要直接使用CPU的资源，相对高级程序设计语言来说，它又显得难掌握。

汇编语言程序归纳起来大概有以下几个主要特性。
### 与机器相关性
汇编语言指令是机器指令的一种符号表示，而不同类型的CPU有不同的机器指令系统，也就有不同的汇编语言，所以，汇编语言程序与机器有着密切的关系。

由于汇编语言程序与机器的相关性，所以，除了同系列、不同型号CPU之间的汇编语言程序有一定程度的可移植性之外，其它不同类型(如：小型机和微机等)CPU之间的汇编语言程序是无法移植的，也就是说，汇编语言程序的通用性和可移植性要比高级语言程序低。
### 执行的高效率
正因为汇编语言有“与机器相关性”的特性，程序员用汇编语言编写程序时，可充分发挥自己的聪明才智，对机器内部的各种资源进行合理的安排，让它们始终处于最佳的使用状态，这样做的最终效果就是：程序的执行代码短，执行速度快。

现在，高级语言的编译程序在进行寄存器分配和目标代码生成时，也都有一定程度的优化(在后续课程《编译原理》的有关章节会有详细介绍)，但由于所使用的“优化策略”要适应各种不同的情况，所以，这些优化策略只能在宏观上，不可能在微观上、细节上进行优化。而用汇编语言编写程序几乎是程序员直接在写执行代码，程序员可以在程序的每个具体细节上进行优化，这也是汇编语言程序执行高效率的原因之一。
### 编写程序的复杂性
汇编语言是一种面向机器的语言，其汇编指令与机器指令基本上一一对应，所以，汇编指令也同机器指令一样具有功能单一、具体的特点。要想完成某件工作(如计算：A+B+C等)，就必须安排CPU的每步工作(如：先计算A+B，再把C加到前者的结果上)。另外，在编写汇编语言程序时，还要考虑机器资源的限制、汇编指令的细节和限制等等。

由于汇编语言程序要安排运算的每一个细节，这就使得编写汇编语言程序比较繁琐、复杂。一个简单的计算公式或计算方法，也要用一系列汇编指令一步一步来实现。
### 调试的复杂性
在通常情况下，调试汇编语言程序要比调试高级语言程序困难，其主要原因有四：
- 汇编语言指令涉及到机器资源的细节，在调试过程中，要清楚每个资源的变化情况；
- 程序员在编写汇编语言程序时，为了提高资源的利用率，可以使用各种实现技巧，而这些技巧完全有可能破坏程序的可读性。这样，在调试过程中，除了要知道每条指令的执行功能，还要清楚它在整个解题过程中的作用；
- 高级语言程序几乎不显式地使用“转移语句”，但汇编语言程序要用到大量的、各类转移指令，这些跳转指令大大地增加了调试程序的难度。如果在汇编语言程序中也强调不使用“转移指令”，那么，汇编语言程序就会变成功能单调的顺序程序，这显然是不现实的；
- 调试工具落后，高级语言程序可以在源程序级进行符号跟踪，而汇编语言程序只能跟踪机器指令。不过，现在这方面也有所改善，CV(CodeView)、TD(Turbo Debug)等软件也可在源程序级进行符号跟踪了。 


## 汇编语言的使用领域
综上所说，汇编语言的特点明显，其诱人的优点直接导致其严重的缺点，其“与机器相关”和“执行的高效率”导致其可移植性差和调试难。所以，我们在选用汇编语言时要根据实际的应用环境，尽可能避免其缺点对整个应用系统的影响。

下面简单列举几个领域以示说明，但不要把它们绝对化。

### 适用的领域
- 要求执行效率高、反应快的领域，如：操作系统内核，工业控制，实时系统等；
- 系统性能的瓶颈，或频繁被使用子程序或程序段；
- 与硬件资源密切相关的软件开发，如：设备驱动程序等；
- 受存储容量限制的应用领域，如：家用电器的计算机控制功能等；
- 没有适当的高级语言开发环境。

### 不宜使用的领域
- 大型软件的整体开发；
- 没有特殊要求的一般应用系统的开发等。
 


