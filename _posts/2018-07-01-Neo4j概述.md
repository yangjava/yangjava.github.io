---
layout: post
categories: [Neo4j]
description: none
keywords: Neo4j
---
# Neo4j概述
Neo4j是一个高性能的,NOSQL图形数据库，它将结构化数据存储在网络上而不是表中。它是一个嵌入式的、基于磁盘的、具备完全的事务特性的Java持久化引擎，但是它将结构化数据存储在网络(从数学角度叫做图)上而不是表中。Neo4j也可以被看作是一个高性能的图引擎，该引擎具有成熟数据库的所有特性。

## 什么是Neo4j
什么是Neo4j呢？Neo4j是一个NoSQL的图数据库管理系统。这里所说的图是指图论中的图这种数据结构，图是一个比线性表和树更高级的数据结构。在Neo4j中，图表示为一些节点和连接这些节点的关系的集合，其中，节点表示实体，关系表示实体之间的连接方式。

在Neo4j中存储的关联数据表现为树状或网络状的形形色色的图，它更加形象和直观地表现了现实世界中的应用场景。Neo4j不但能给人一种耳目一新的感觉，更重要的是它能始终保持高效的查询性能，不会因为数据的增长而降低了查询的反应能力。
Neo4j是一个NoSQL数据库，像其他NoSQL数据库一样具有高效的查询性能。同时，Neo4j还具有完全事务管理特性，完全支持ACID（Atomicity，Consistency，Isolation，Durability）事务管理。
实践证明，图数据库具有很强的表现力。像 Facebook中巨大的社交数据，Google搜索引擎的海量网页，或者现实世界中繁杂的交通网络，大至宏观世界的天文数据，小至微观世界的量子模型等，现实世界中不同领域的数据都可以使用图数据库来存储和访问。
Neo4j自2010年2月发布1.0.0版本，经过几年时间一些大中型企业的使用实践，可以充分证明Neo4j是一个成熟的数据库，同时也是一个安全可靠的数据库管理系统。

## Neo4j数据的特点
在Neo4j数据库中存储的图数据，相比于大家比较熟悉的关系型数据库来说，它没有模式结构（如表或视图等逻辑结构的定义），而是用节点和关系的属性来表现实体的内容。使用属性，可以让Neo4j的图数据具有更加出色的表现能力，使其像关系型数据库那样包含非常丰富的内容。

Neo4j的图数据结构具有如下基本特征：
- 节点、关系和属性是构成图数据的三个基本要素。
- 节点和关系的属性是一个Key-Value的数据集合。
- 每个关系都有一个开始节点和一个结束节点相互连接。
- 大多数情况下关系可以不需要属性。
从以上特征中可以看出，Neo4j存储的数据是一个属性图。其中，节点表示一个实体，实体可以是人、事物或者任何一种定义，节点的属性就是实体的内容。而实体之间的关联表现为节点的关系，比如朋友关系、从属关系等。

从总体来看，Neo4j就是由无数相互联系的节点所组成的图形，它能很好并且形象地表现出现实世界中相互联系的事物。从这一方面来说，Neo4j存储的数据更能体现事物之间相互联系的本质，这种关联数据表现出了现实场景中事物本来的样子。

## Neo4j数据的表现形式
由于Neo4j并不需要模式结构定义，因而非常适合用来存储非结构化或半结构化的数据，所以在数据表现形式上，与RDBMS或其他NoSQL数据库相比，都具有绝对的优势。

例如，在使用RDBMS设计数据库时，一般遵循这样一条规则：首先要做一些数据模型的分析，然后再进行实体-关系模型的设计，接下来才开始定义一些表结构。在这个过程中，必不可少地需要考虑一些范式规范，以便让存储的数据可以避免过多的冗余。最后可能为了一些性能要求，还会反过来使用一些反范式设计，再增加一点冗余字段。经过所有这些工作之后，才能确定数据结构的定义。而当数据结构确定之后，就不能再有大的变更了，否则整个系统结构都要跟着更改。
纵观使用RDBMS的整个设计和开发过程，有时你会觉得，在这种情况下的程序开发者似乎显得太蹩脚了。虽然明知这些工作很烦琐，但还是要求你必须得这样做。
使用Neo4j来设计数据库，就不需要有这么多繁琐的过程，我们只需借助于在做业务需求时画出的一些简单框图，就可以用来作为数据模型，很容易地将其转化为图数据结构。
```text
[部门] 《=属于  [用户]
 ```
例如，如上图所示的简单框图，它可以表示有用户和部门两个实体，并且它们之间存在一种隶属关系。至于在框图中是使用方框还是圆框则完全根据个人喜好，并没有什么区别。在使用Neo4j来进行数据库设计时，使用这个简单的框图就足够了。要用Neo4j来表现这一数据，将会存储部门和用户这两个节点，以及一个连接这两个节点的隶属关系。

## 综合表现
Neo4j查询的高性能表现、易于使用的特性及其设计的灵活性和开发的敏捷性，以及坚如磐石般的事务管理特性，都充分说明了使用Neo4j是一个不错的选择。有关它的所有优点，总结起来，主要表现在以下几个方面。
- 闪电般的读/写速度，无与伦比的高性能表现。
- 非结构化数据存储方式，在数据库设计上具有很大的灵活性。
- 能很好地适应需求变化，并适合使用敏捷开发方法。
- 很容易使用，可以用嵌入式、服务器模式、分布式模式等方式来使用数据库。
- 使用简单框图就可以设计数据模型，方便建模。
- 图数据的结构特点可以提供更多更优秀的算法设计。
- 完全支持ACID完整的事务管理特性。
- 提供分布式高可用模式，可以支持大规模的数据增长。
- 数据库安全可靠，可以实时备份数据，很方便恢复数据。
- 图的数据结构直观而形象地表现了现实世界的应用场景。

## 哪些领域更适合使用Neo4j
Neo4j从推出至今，已经经历了几年时间的考验和锤炼，原则上可以应用于任何领域。从大量的应用实践中可以看出，Neo4j在处理关联数据时更能体现出它的绝对优势。例如，社区网络、推荐引擎、地理（网络）数据、主数据存储、访问控制、欺诈检测、物流管理等，都在实际应用中表现出无与伦比的优势。

#### 社区网络
在一个社区中，人与人之间具有亲属、同事、朋友等各种关系，而每个人又有不同的兴趣、爱好，并且从事各种不同的活动。如果社区庞大，各种关系又纷纭复杂，那么使用一般的关系型数据库或其他 NoSQL数据库来管理，是很难厘清这些数据及其关系的。如果我们把这之中的人和各种事物及其关系使用节点和关系的形式存储在Neo4j的图数据库中并用它来进行数据管理，这不仅是一件极其容易的事情，并且对其中的各种关系也能做到脉络清楚、有条不紊。而且在Neo4j中通过关联数据管理，还可以很容易地发现或发掘这些数据中各种各样的价值。例如，在一个社区网络中，通过每个人的爱好这一关系，人们可以认识更多的朋友，还可以由此组织一些让人更加感兴趣的活动等。

### 推荐引擎
由社区网络的数据累积和沉淀就可以引申出一个推荐引擎。比如在一个电影社区中，哪些观众在哪里看了哪些电影，并对哪些电影做了哪些评价。有了这些数据之后，我们就能做一个电影社区推荐引擎，让这些数据产生不可估量的商业价值。例如，当前有哪几部电影是被观众所追捧的，而这些电影还有哪些观众没有看过，在这些观众之中，哪些是比较活跃的，哪些是具有朋友关系的，这样就可以将这几部电影对各个群体进行有目的的推荐。这种推荐就是最有效的，对于电影院来说，这无疑是一种商业价值。

### 交通运输
庞大的交通系统，如航运、海运、铁路运输、公路运输等，任何一种运输系统都将连接世界各地，大到全球、全国，小到地区、城市运输，这里面的运输工具、线路、站点以及班次、调度等各种数据，庞大而又繁杂交错，这些数据使用Neo4j来存储和管理会显得脉络清楚、井然有序，因为图的数据结构正好体现了这种数据的特性。使用图的遍历算法能够很快地计算出从一个站点到另一个站点的最短路径。

### 物流管理
物流管理是交通网络的一个具体应用。对于一个大型的物流系统来说，几秒钟就有可能增加几百个甚至几千个包裹。如果是在一个城市中，那么这一个个包裹将分布于不同区域和街道之中，而要使包裹能够尽快地送达用户手中，在包裹分拣中心要找出每一个包裹配送的最短路径，再将它分配到不同的配送点，这时，Neo4j就能发挥它的特长了。

### 主数据管理
对于一些结构化数据，例如客户资料、组织数据、产品数据等，使用Neo4j来存储和管理，可以很好地避免数据僵化，让数据具有实时价值，充满活力。不管是自上而下的查询，还是使用遍历，都能保持高效的查询性能。使用Neo4j灵活的属性管理还能让数据适应组织及产品结构的变迁和演化。

### 访问控制
如果有一个大型平台，它有成千上万的用户，并且有成倍的资源，那么对于这些资源的访问，必须要有一个有效的控制系统，以控制哪些用户能够访问哪些特定的资源，或者哪些用户不能访问哪些资源等。使用Neo4j来处理这些关联数据及实现访问控制正是它的特长。

### 欺诈检测
涉及银行卡、信用卡的欺诈交易，或者电信诈骗事项，使用关联数据可以厘清一个账号或一个电话号码的关系和行为，很容易在这些关系和行为之中找出某些异常的举动，从而能很快地检测出欺诈或诈骗行为。所以使用Neo4j来建立欺诈检测系统，或者使用关联数据来进行预测、推荐建议等做法都是不错的选择。

其他应用领域，如金融、教育、零售、科学、新闻调查、卫生保健等，Neo4j都能发挥它的长处。总之，使用Neo4j不但可以很好地管理繁杂的关联数据，也能适应大规模的数据增长，并且能连接不同领域的数据，提供最全面和最快的实时反应速度。

## 哪些领域不适合使用Neo4j
从上面的介绍中可以看出，Neo4j的应用领域涵盖了很广的范围，几乎所有领域都可以使用。但是，世界上没有万能的东西，下面一些领域就不推荐使用Neo4j。
- 记录大量基于事件的数据。
- 需要对大规模分布式数据进行处理（以PB级别计算的数据）。
- 二进制数据存储。
- 适合保存在关系型数据库中的结构化数据。
  注意，Neo4j企业版是要收费的，而只有企业版才能使用分布式安装，并且可以提供负载均衡和高可用配置等功能。社区版只能单机使用，最多可以使用数十亿个节点、关系和属性。

## Neo4j的安装
Neo4j有两个版本，分别是社区版（Community Edition）和企业版（Enterprise Edition）。社区版是免费并且开源的，但只适用于单实例部署，即只能用于单机安装和使用。不过，社区版已经具备了Neo4j的全部功能，包括可编程的API调用、Cypher查询语言使用和ACID事务管理等。社区版非常适合用来构建一个小型项目，或者用于项目的前期开发和调试。

### Docker安装Neo4j
- 从镜像源中找合适的镜像：docker search neo4j，或者到dockerhub上查找：https://hub.docker.com/_/neo4j/tags
- 拉取镜像源docker pull neo4j:4.4.17-community ，也可以加上版本号
- 查看本地镜像，检查是否拉取成功，docker images
- 构建neo4j容器
```text
docker run -d --name neo4j \
	-p 7474:7474 -p 7687:7687 \
	-v /home/neo4j/data:/data \
	-v /home/neo4j/logs:/logs \
	-v /home/neo4j/conf:/var/lib/neo4j/conf \
	-v /home/neo4j/import:/var/lib/neo4j/import \
	--env NEO4J_AUTH=neo4j/root neo4j:4.4.17-community
```
- data——数据存放的文件夹
  logs——运行的日志文件夹
  conf——数据库配置文件夹（在配置文件neo4j.conf中配置包括开放远程连接、设置默认激活的数据库）
  import——为了大批量导入csv来构建数据库，需要导入的节点文件nodes.csv和关系文件rel.csv需要放到这个文件夹下）
  其中container_name可以自己指定。另外NEO4J_AUTH也是你自己来进行设置。
简化命令
```text
docker run -d --name neo4j -p 7474:7474 -p 7687:7687 -v /home/neo4j/data:/data -v /home/neo4j/logs:/logs -v /home/neo4j/conf:/var/lib/neo4j/conf -v /home/neo4j/import:/var/lib/neo4j/import --env NEO4J_AUTH=neo4j/root neo4j:4.4.17-community
```
然后在浏览器中输入：http://192.168.56.101:7474/，ip为启动服务的主机地址。
输入构建容器时配置的用户名和密码即可。
需要说明的是：
- 社区版本不支持命令create database xxx，只有企业版可以！
- 社区版本只允许同时打开一个数据库


# 参考资料
官网地址：[https：//neo4j.com](https：//neo4j.com)