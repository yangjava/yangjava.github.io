---
layout: post
categories: [Python]
description: none
keywords: Python
---
# Python机器学习支持向量机分类


## 支持向量机分类
支持向量机（Support Vector Machine，SVM）的基本原理是找到一个将所有数据样本分割成两部分的超平面，使所有样本到这个超平面的累计距离最短。什么是超平面呢？超平面是指n维线性空间中维度为n-1的子空间。例如，在二维平面中，一维的直线可以将二维平面分割成两部分；在三维空间中，二维的平面可以将空间分成两部分。

显然，SVM是一种二分类模型。SVM在解决小样本、非线性及高维模式识别中表现出许多特有的优势，并且还能够推广应用到函数拟合等其他机器学习问题中。不过，SVM解决多元分类问题时效率较低，也难以对大规模训练样本实施训练。

Scikit-learn的支持向量机子模块（svm）提供了三个分类模型：LinearSVC、NuSVC和SVC。SVC分类模型和NuSVC分类模型的方法类似，都是基于libsvm实现，它们的区别是损失函数的度量方式不同（NuSVC分类模型中的nu参数和SVC分类模型中的C参数）；LinearSVC分类模型实现了线性分类支持向量机，基于liblinear实现，既可以用于二类分类，也可以用于多类分类。

使用的威斯康星州乳腺癌数据集只有良性和恶性两个标签，正好适合测试支持向量机分类模型。以下代码使用交叉验证函数测试了三个分类模型的分类精度。其中SVC分类模型和NuSVC分类模型均使用默认参数，而LinearSVC分类模型指定了参数dual为False（当样本数量大于特征数量时，参数dual倾向为False，否则liblinear不收敛）。

```
>>> from sklearn.datasets import load_breast_cancer
>>> from sklearn.model_selection import cross_val_score
>>> from sklearn import svm
>>> ds = load_breast_cancer() # 加载威斯康星州乳腺癌数据集
>>> msvc = svm.SVC() # 实例化SVC分类模型
>>> mnusvc = svm.NuSVC() # 实例化NuSVC分类模型
>>> mlsvc = svm.LinearSVC(dual=False) # 实例化LinearSVC分类模型
>>> score_msvc = cross_val_score(msvc, ds.data, ds.target, cv=10)
>>> score_mnusvc = cross_val_score(mnusvc, ds.data, ds.target, cv=10)
>>> score_mlsvc = cross_val_score(mlsvc, ds.data, ds.target, cv=10)
>>> score_msvc.mean() # SVC分类模型交叉验证10次的平均精度
0.9138784461152882
>>> score_mnusvc.mean() # NuSVC分类模型交叉验证10次的平均精度
0.8734962406015038
>>> score_mlsvc.mean() # LinearSVC分类模型交叉验证10次的平均精度
0.9542931402580526
```
针对威斯康星州乳腺癌数据集的分类，LinearSVC分类模型的表现最好，准确率超过95%，NuSVC分类模型和SVC分类模型的表现只能算差强人意。









