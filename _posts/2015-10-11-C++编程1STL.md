---
layout: post
categories: [C++]
description: none
keywords: C++
---
# C++编程1STL

## 在程序中使用STL
因为STL已经是C++标准库的一部分，所以无须其他额外操作就可以在C++代码中直接使用STL。根据功能的不同，STL中的各个容器和算法被组织在多个头文件中，要想在程序代码中简单地使用STL，只需要引入相应的头文件，并使用对应的std名字空间即可。

我在这儿口口声声说STL如何如何好使用如何如何简单，我相信即使我说得口吐白沫大家也不会有什么感觉。那么，我们下面不妨先来看个实际的例子，将STL应用到刚刚的工资程序中， 看看它到底是如何让一个“粗鲁”的程序“优雅”起来的：
```
// ...

#include <vector>     // 为了使用vector容器
#include <algorithm> // 为了使用count_if()算法

using namespace std;  // 使用std名字空间

// …
// 使用STL改写后的可以统计高工资员工数的SalarySys类
class SalarySys
{
// …
public:
    // …
    int GetMaxCount()
    {
         int nTotal = 0;
	// 使用count_if()算法统计工资大于1000的员工人数
         nTotal = count_if(m_vecEmp.begin(),   // 统计范围开始
             m_vecEmp.end(),               // 统计范围结束
             [=](Employee* p)->bool  // 统计规则
             {
                 return p->GetSalary() > 1000;
             });

         return nTotal; // 返回统计结果
    }

    // …
private:
    vector<Employee*> m_vecEmp; // 使用容器取代数组
};
```
在这段程序中，我们使用了vector容器代替数组来组织和管理员工数据，同时使用了count_if()算法代替for循环来完成符合条件（工资大于1000）员工的统计。正是它们的使用，使得整个程序“优雅”起来。

这里大家可能会问，从上面的例子是可以看出STL的使用十分简单，但是说它“优雅”又是如何体现的呢？STL到底还在哪儿？俗话说的好，不怕不识货就怕货比货。将前面的“粗鲁”的工资程序跟我们用STL改写的“优雅”的工资程序做个简单比较，马上就可以看出STL到底好在哪儿了：

用vector容器取代数组管理数据，内存空间的使用更加合理。虽然使用数组可以管理员工数据，但数组有一个天然的缺点——它的大小是固定的。我们必须在定义数组的时候就指定数组的大小，而正是固定不变的大小给它的使用带来了麻烦：如果一开始定义的数组过大，但数据不够多，最后会造成内存资源的浪费。反过来，如果一开始定义的数组过小而数据又比较多，那么就会出现数组空间不够用的情况，不利于程序的扩展。而在“优雅“工资程序中使用的vector容器很好地弥补了数组的缺点，完美地解决了上面的问题。vector容器的大小不是固定的，它可以根据我们的需要动态地自动调整，如果数据较多，它就会自动调大自己的容量，反过来，如果数据较少，它又会自动调小自己的容量。这样一来，vector容器既不会浪费内存资源，也不会出现容量不够的情况，对内存的使用就更加合理。

用count_if()算法取代for循环提高了开发效率，增加了程序的可维护性。在“粗鲁”的工资程序中，我们使用了一个for循环来统计数组中工资大于1000元的员工人数，这样做虽然管用，但是显得很生硬。首先，for循环需要知道数组中已经保存的有效员工数，这就需要增加一个额外的变量m_nCount来记录。另外，如果想对其进行扩展，统计其他工资范围内的员工个数，或者是统计其他项目，那么还需要写另外一个for循环，这样会使得整个程序变得纷繁复杂，降低了开发效率，同时也增加了后期的维护成本。如果使用STL中的count_if()算法，再配合使用vector容器，就可以很好地解决这些问题。通过vector的begin()和end()函数，我们可以方便地得到统计范围，而通过count_if算法中的Lambda表达式，我们可以自由定义统计规则。

从这里就看出了STL的好处就在于，容器和算法的配合使用，不仅弥补了传统编程方法的某些固有缺点，提高了开发效率，同时因为容器和算法的通用性， 使得程序更易于维护和扩展。STL好是好，那么它又是如何做到这一点的呢？