---
layout: post
categories: [C]
description: none
keywords: C
---
# C字符串

## 字符串简介
在C语言中并没有字符串基本数据类型。与其他程序设计语言相比（如Visual Basic），C语言在字符串处理方面较为复杂。在C程序中存储字符串可以使用字符数组的方式，不过最后一个字符必须以空字符（\0）作为结尾。

## 字符串的使用
字符串声明的第一个重点就是必须使用空字符（\0）代表每一个字符串的结束，以下是C语言中常用的两种字符串声明方式：
```
方式1：char 字符串变量[字符串长度]="初始字符串";
方式2：char 字符串变量[字符串长度]={'字符1', '字符2', ...... ,'字符n', '\0'}; 
```

判断以下4种字符串声明方式是否合法：
```
      char Str_1[6]="Hello";
      char Str_2[6]={ 'H', 'e', 'l', 'l', 'o' , '\0'};
      char Str_3[ ]="Hello";
      char Str_4[ ]={ 'H', 'e', 'l', 'l', 'o', '!' };
```
其中，第一、二、三种方式中都是合法的字符串声明。虽然Hello只有5个字符，但是因为编译程序还必须加上\0字符，所以数组长度需声明为6，如果声明的长度不足，就可能造成编译上的错误。当然也可以选择不填入数组大小，让编译程序来自动分配内存空间（如第三种方式）。但是Str_4并不是字符串，因为最后一个字符并不是\0。

小技巧：在给字符串变量设置初始值时，如果字符串内容太长而无法在一行中设置完成，就可以将字符串拆成两个都用双引号括住的独立字符串，或者使用反斜杠（\）来连接两边的断点。例如：
```
char ch1[]="Could you tell me where the Tourist Information " 
     "Office is located";
  /* 分成多个字符串,中间的空格与换行将不会影响字符串的连接*/ 
char ch2[]="Could you tell me where the Tourist Information\
       Office is located"; 
   /* 以反斜杠连接断点的两边 */
```
下面的范例程序将介绍4种字符串声明的方式，大家可以实际运行并比较其中的不同之处。
```
01  #include <stdio.h>
02  #include <stdlib.h>
03  
04  int main()
05  {
06       
07       /* 4种字符串声明与设置初值的方式 */ 
08       char Str_1[6]="Hello";
09       char Str_2[6]={ 'H', 'e', 'l', 'l','o','\0'};
10       char Str_3[ ]="Hello";
11       char Str_4[ ]={ 'H', 'e', 'l', 'l', 'o', '!' };
12         
13       
14       printf("%s\n",Str_1);
15       printf("%s\n",Str_2);
16       printf("%s\n",Str_3);
17       printf("%s\n",Str_4);
18       
19       system("pause");
20       return 0;
21  }
```
- 第8~10行：合法的字符串声明方式。
- 第11行：声明的仅是一种字符数组，因为没有结尾字符（\0），不能算是字符串。
- 第17行：输出数据时，屏幕上会出现奇怪的符号。

## 字符串数组
由于字符串是以一维字符数组存储的，如果有许多关系相近的字符串集合，就称为字符串数组，并可以使用二维字符数组来表示。例如，一个班级中所有学生的姓名、每个姓名都是由许多字符所组成的字符串，这时就可以使用字符串数组存储。字符串数组声明方式如下：
```
char 字符串数组名[字符串数][字符数]；
```
上式中字符串数用来表示字符串的个数，而字符数表示每个字符串的最大可存放字符数，并且包含(\0)结尾字符。当然也可以在声明时就设置初始值，不过要记得每个字符串元素都必须包含在双引号内，而且每个字符串间要以逗号（,）分开。语法格式如下：
```
char 字符串数组名[字符串数][字符数]={ "字符串1", "字符串2", "字符串3"…}；
```
例如，声明名字为Name的字符串数组包含5个字符串，每个字符串都包括\0字符，字符串长度为10个字节：
```
char Name[5][10]={  "John",  
           "Mary",    
           "Wilson",
           "Candy",
            "Allen"
            };
```
字符串数组虽然是二维字符数组，但是当我们要输出此Name数组中第二个字符串时，可以直接以printf("%s",Name[1])的方式打印输出一维数组。而要输出第二个字符串中的第一个字符时，仍然必须使用二维数组的输出方式，例如printf("%s",Name[1][0])。

使用字符串数组存储的坏处是每个字符串长度不会完全相同，而数组又属于静态内存分配，必须事先声明字符串中的最大长度，这样就可能造成内存的浪费。

下面的范例程序介绍字符串数组的应用，用来存储由用户输入的3位学生的姓名及每一位学生的3科成绩，并以横列方式输出每位学生的姓名、3科成绩及总分。
```
01  #include <stdio.h>
02  #include <stdlib.h>
03  
04  int main()
05  {
06     char name[3][10],score[3][3];/* 声明存储姓名与成绩的数组 */ 
07     int i,total;
08     
09     for(i=0;i<3;i++)
10      {
11      printf("请输入姓名及三科成绩:"); 
12      scanf("%s",&name[i]);/* 输入每一位学生的姓名 */
13      scanf("%d %d %d",&score[i][0],&score[i][1],&score[i][2]);
14      /* 输入3科成绩 */ 
15      }
16     printf("-------------------------------------\n");
17     
18     for(i=0;i<3;i++)
19      {
20       printf("%s\t%d\t%d\t%d",name[i],score[i][0],score[i][1],score[i][2]); 
21       total=score[i][0]+score[i][1]+score[i][2];/* 计算3科的总分 */ 
22       printf("\t%d\n",total);/* 输出3科的总分 */ 
23      }
24      printf("-------------------------------------\n");
25       
26      system("pause");
27      return 0;
28  }
```
- 第6行：声明存储姓名与成绩的两个数组。
- 第12、13行：以scanf()函数输入每一位学生的姓名字符串与3科成绩。
- 第20行：直接以一维数组name[i]输出每位学生的名字。
- 第21行：计算3科成绩的总分。

## 字符串处理功能
由于字符串不是C语言的基本数据类型，因此如果大家要对字符串进行运算处理，就必须有一些特殊技巧。接下来介绍一些字符串的基本处理方法，包括计算字符串长度、复制、连接和搜索等方法，通过这些功能操作让大家更清楚C语言中字符串的相关应用。

下面的范例程序是计算一个输入字符串的长度，使用while循环从字符串中一个一个地取出字符来累加，直到遇到字符串的结尾字符（\0）才停止，最后输出累加结果。
```
01  #include<stdio.h>
02  #include<stdlib.h>
03  
04  int main()
05  {
06    int length;/*用于计算字符串的长度*/
07    char str[30];/* 声明此字符串最多可存储30个字符*/ 
08    
09    printf("请输入字符串:");
10    /*输入字符串*/
11    gets(str);
12    printf("输入的字符串为:%s\n",str);
13    length=0;
14    while (str[length]!='\0')
15     length++; 
16     printf("此字符串有%d个英文字符\n",length);
17      
18      system("pause");
19      return 0;
20  }
```
- 第6行：length变量用于计算字符串的长度。
- 第7行：声明此字符串最多可存储30个字符。
- 第11行：以gets()函数输入字符串，字符串中可以有空格。
- 第13行：声明length=0。
- 第14、15行：使用while循环，若当前字符不是结尾字符，则length变量累加1。
- 第16行：输出这个字符串的字符数。

下面的范例程序用于示范两个字符串的连接功能，也就是将S2字符串接到S1字符串后面。在这个程序中，我们使用record整数变量作为S3字符数组的下标值，再使用复制字符串的方法将S1、S2字符串复制到S3，得到新连接好的字符串。
```
01  #include <stdio.h>
02  #include <stdlib.h>
03  
04  int main()
05  {
06    char S1[30];         
07    char S2[30];        
08    char S3[60];          
09    int count,record;
10      
11   printf("字符串 S1 的内容:");
12      gets(S1);           
13    printf("字符串 S2 的内容:");
14    gets(S2);             
15  
16    record=0; /* 把整数变量 record 归 0，用来记录 S3 所指向的数组元素 */
17  
18   for (count=0; S1[count] != '\0'; count++, record++) /* 将 S1 字符串复制到 S3 */
19      S3[record]=S1[count];
20  
21    for (count=0; S2[count] != '\0'; count++, record++) /* 将 S2 字符串复制到 S3 */
22      S3[record]=S2[count];
23  
24    S3[record]='\0';/* 字符串最后要加上 NULL 字符 */
25  
26      printf("连接后的字符串 S3:%s", S3);/* 显示字符串连接后的结果 */
27    printf("\n");   /* 换行 */
28      
29      system("pause");   
30      return 0;               
31  }
```
- 第8行：声明连接后的新字符串数组，首先要注意声明字符串数组的大小，如果串接后超过字符串声明的大小，编译程序就会自动清除后面连接的字符串。
- 第16行：把整数变量record的初始值设为0，用来记录S3所设置数组元素的下标值。
- 第18行：将S1字符串复制到S3。
- 第21行：将S2字符串复制到S3。
- 第24行：要在字符串最后加上NULL字符。
- 第26行：显示字符串连接后的结果。

## 字符串处理函数
字符串的处理功能除了可以自行设计外，其实在C语言的函数库中已经提供了相当多的字符串处理函数，只要我们在程序代码中包含string.h头文件，即可充分运用各种字符串函数的功能，本节中列举了一些实用的函数范例说明。

下面的范例程序使用strlwr()函数将字符串中的大写字母全部转换成小写字母，使用strcat()函数将str2字符串连接到str1字符串相关的使用方式如下：
```
strlwr(str);
strcat(str1,str2);

01  #include <stdio.h>
02  #include <stdlib.h>
03  #include <string.h>/* 包含 <string.h> 头文件 */
04  
05  int main()
06  {
07       
08       char str1[40]; 
09       char str2[40];
10       
11       printf("请输入第一个字符串:"); 
12       gets(str1);
13       printf("请输入第二个字符串:"); 
14       gets(str2);
15       
16       strcat(str1,str2);/* 将两个字符串连接起来 */ 
17       printf("%s\n",strlwr(str1));/* 将字符串内的大写字母转为小写字母 */ 
18       
19       system("pause");
20       return 0;
21  }
```
- 第3行：包含<string.h>头文件，因此能够使用C语言的字符串相关函数。
- 第16行：使用strcat()函数将str2字符串连接到str1字符串。
- 第17行：将字符串内的大写字母转为小写字母。

下面的范例程序使用gets()函数与strlen()函数将所输入的字符串反向打印输出，建议大家使用字符数组的方式来处理，从最后一个元素往前逐一输出。strlen()函数的功能是输出字符串str的长度，使用方式如下：
```
strlen(str);

01  #include <stdio.h>
02  #include <stdlib.h>
03  #include <string.h>
04  
05  int main()
06  {
07     char Word[40];/* 声明字符数组 */ 
08     int i,j=0;
09     
10     printf("请输入字符串:"); 
11     gets(Word);
12     
13     for(i=strlen(Word)-1;i>=0;i--)/*使用strlen()函数*/  
14       printf("%c",Word[i]);/* 反向打印字符串 */ 
15        
16     printf("\n");
17     
18     system("pause");
19     return 0;
20  }
```
- 第7行：声明输入字符串变量最大长度的数组。
- 第11行：使用gets()函数，允许所输入的字符串中含有空格符。
- 第13、14行：使用C语言的库函数strlen()逐一反向打印输出字符。












