---
layout: post
categories: [Job]
description: none
keywords: Job
---
# 分布式任务调度实战


## 定时任务概述
定时任务是按照指定时间周期运行任务。使用场景为在某个固定时间点执行，或者周期性的去执行某个任务，比如：每天晚上24点做数据汇总，定时发送短信等。

### 常见定时任务方案
- While + Sleep ：通过循环加休眠的方式定时执行
Timer和TimerTask实现 ：JDK自带的定时任务，可以实现简单的间隔执行任务（在指定时间点执行某一任务，也能定时的周期性执行），无法实现按日历去调度执行任务。
ScheduledExecutorService : Java并发包下,JDK1.5出现，是比较理想的定时任务实现方案。Eureka就是使用的它
QuartZ : 使用Quartz，它是一个异步任务调度框架，功能丰富，可以实现按日历调度,支持持久化。
使用Spring Task，Spring 3.0后提供Spring Task实现任务调度，支持按日历调度，相比Quartz功能稍简单，但是在开发基本够用，支持注解编程方式。
SpringBoot中的Schedule ：通过@EnableScheduling+@Scheduled最实现定时任务，底层使用的是Spring Task

## 分布式定时任务

### 遇到什么问题
上述的定时任务都是集中式(单体项目使用)的定时任务，在分布式中将会面临一些问题或不足：
- 业务量大，单机性能瓶颈需要扩展
- 多台机器部署如何保证定时任务不重复执行
- 定时任务时间需要可调整，可以暂停
- 机器发生故障down机，定时任务依然可用，如何实现故障转移
- 定时任务，执行日志是否可监控