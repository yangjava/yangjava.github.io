---
layout: post
categories: [Doris]
description: none
keywords: Doris
---
# MatrixOne数据库
MatrixOne 是一款超融合异构分布式数据库，通过云原生化和存储、计算、事务分离的架构构建 HSTAP 超融合数据引擎，实现单一数据库系统支持 OLTP、OLAP、流计算等多种业务负载，并且支持公有云、私有云、边缘云部署和使用，实现异构基础设施的兼容。

MatrixOne 具备实时 HTAP，多租户，流式计算，极致扩展性，高性价比，企业级高可用及 MySQL 高度兼容等重要特性，通过为用户提供一站式超融合数据解决方案，可以将过去由多个数据库完成的工作合并到一个数据库里，从而简化开发运维，消减数据碎片，提高开发敏捷度。

MatrixOne 适用于需要实时数据写入，数据规模较大，负载波动频繁，同时拥有流程型业务和分析型业务的场景，比如移动互联网 APP、IoT 数据应用、实时数据仓库、SaaS 平台等。

## 混合负载 HTAP
MatrixOne 是一款能够支持 HTAP（Hybrid Transaction Analytical Processing）混合负载处理的数据库，旨在提供满足单一数据库内事务处理（TP）和分析处理（AP）所有需求的解决方案。凭借其存储和计算事务的解耦架构，MatrixOne 能够在同一数据引擎中同时支持在线交易和实时统计分析，同时提供高效的资源隔离机制。这种设计大大保留了数据的新鲜度，省去了在许多业务场景中构建实时数据仓库的步骤，从而帮助客户实现其业务价值。

## 技术架构
MatrixOne 通过模块化的存储、计算和事务架构，多级存储体系，以及负载处理链路隔离的模式来实现 HTAP。

存储、计算、事务模块化分离
MatrixOne 的整体技术架构采用完全的存储和计算分离架构。通过模块化设计，将数据库的计算、存储、事务处理分离为单独的模块，从而组建出一套各组件都具有独立伸缩能力的数据库系统。如下图所示，MatrixOne 由三个独立层级构成

- 计算层，以计算节点 Compute Node 为单位，实现计算和事务处理的无服务器化，并有自己的 Cache，支持随意重启和扩缩容；多个 Compute Node 可以并行计算，提升查询效率。
- 事务层，由数据库节点 Transaction Node 和日志节点 Log Service 组成，提供完整的日志服务以及元数据信息，内置 Logtail 用于保存最近写入的新数据。
- 存储层，所有数据均保存在以 S3 为代表的对象存储中，实现了低成本、无限扩展的存储方式，通过命名为 File Service 的统一文件操作服务，实现了不同节点对底层存储的无感知操作。

## 多级存储体系
MatrixOne 的存储体系由全量数据共享存储、少量共享日志和计算节点的无状态缓存组成。

全量数据保存在对象存储中，作为整个数据库的主存储，也是数据持久化的唯一保存位置。对象存储具有成本低廉，扩展性近乎无限的特性。
LogService 提供共享日志服务，用于对整个集群的写入/更新等事务信息进行状态信息保存，它是整个集群唯一带状态的组件。因此，LogService 需要以分布式 Raft 协议以 3 节点的形式保证高可用。但是它只保留一段时间的事务处理日志，我们称之为 Logtail。隔一段时间，就会有 TN 来帮助将历史日志进行压缩，存入 S3，因此 Logtail 可以保持一个非常精简的数据大小，一般在几 GB 左右。
每个计算节点 CN 上都有缓存，在用户初次查询时，会从对象存储中读取相关数据并放入缓存中，作为热数据。当客户再次查询相同内容时，如果命中缓存，将会快速向用户返回查询结果。关于缓存带来的冷热数据分离的技术特性，可以参考数据缓存及冷热数据分离架构详解。另外，除了读取对象存储中的数据外，CN 节点还会向 LogService 订阅 Logtail 的数据，LogService 中有新的更新会即时推送给 CN。
